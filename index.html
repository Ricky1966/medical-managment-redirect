<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Auth Redirect</title>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const url    = new URL(window.location.href);
      const params = new URLSearchParams([...url.searchParams]);

      // supabase aggiunge automaticamente  token & type=
      const type = params.get('type');  // "signup" o "recovery"
      let host;
      if (type === 'recovery') {
        host = 'reset-password';
      } else if (type === 'signup') {
        host = 'login-callback';
      } else {
        console.error('Unknown auth type:', type);
        return;
      }

      // ricomponi tutti i parametri (incluso email se c’è)
      const deepLink = `io.supabase.flutter://${host}?${params.toString()}`;
      console.log('➔ Deep link:', deepLink);
      window.location.replace(deepLink);
    });
  </script>
</head>
<body>
  <p>Reindirizzamento in corso… apri la console (F12) per i dettagli.</p>
</body>
</html>

